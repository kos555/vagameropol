window.cisGalleryIsReady=!0,function(a){a.fn.CreanetGallery=function(a,b){if(!a)var a={};return this.each(function(){a.obj=this,new CreanetGallery(a,b)})}}(jQuery);var CreanetGallery=function(options,fx){this.options=$.extend({id:!1,obj:!1,showTime:5e3,animateSpeed:700,animateType:"fade",easingType:"linear",verticalFormat:!1,scale:!0,autoplay:!0,autoStop:!0,touchControl:!0,keyControl:!0,showTopNav:!0,detectBrightness:!1,showNav:!1,showPageNum:!1,showThumbnail:!1,scrollThumbnailNum:3,autoThumbnailScroll:!0,showNavPoints:!1,showComments:!1,randomOrder:!1,shadowBox:!1,shadowBoxComments:!0,beta:!1},options),this.width=0,this.height=0,this.imgArray=new Array,this.loop=!1,this.position=0,this.lastPosition=0,this.imageNum=0,this.fadeStatus=!1,this.thumbnailWidth=0,this.thumbnailContent=!1,this.thumbnailContentWidth=0,this.mouseFirstEvent=!1,this.fx=fx;for(var name in this.options)eval("this."+name+"=this.options."+name);this.options.obj?this.obj=this.options.obj:this.obj=$(this.options.id),this.obj?$(this.obj).find("img").length?this.init():this.message("No image object or double init"):this.message("No galerie object")};CreanetGallery.prototype={init:function(){var a=this,b=$(this.obj).find("img");this.imageNum=$(b).length,this.lastPosition=$(b).length;var c=0;$(this.obj).append($("<div class='loader'>")).hide().fadeIn(500),this.imageNum<=1&&(this.touchControl=!1,this.keyControl=!1,this.showTopNav=!1,this.showNav=!1,this.showPageNum=!1,this.showThumbnail=!1,this.showNavPoints=!1,this.autoplay=!1),$(this.obj).attr("data-type",this.animateType).addClass("cis-gallery"),$(b).each(function(b,d){a.imgArray[b]=new Array,a.imgArray[b].image=new Image,a.imgArray[b].comment=$(this).attr("alt"),a.imgArray[b].brightness=0,a.imgArray[b].image.src=$(d).attr("src"),a.imageLoader(a.imgArray[b].image,function(){a.setBrightness(a.imgArray[b]),c++,c==a.imageNum&&a.build(function(){a.start()})},function(){a.message("Error load image "+(b+1)),delete a.imgArray[b],a.imageNum--,c==a.imageNum&&a.build(function(){a.start()})}),$(this).remove()})},build:function(a){var b=this;this.randomOrder&&this.imgArray.sort(function(){return.5-Math.random()});var c="<div class='overflow'><div class='inner-content'>";$(this.imgArray).each(function(a,d){if(d){var e="";e+=b.scale?d.image.width<d.image.height&&b.verticalFormat?" verticalFormat":" horizontalFormat":" noScaleFormat",b.detectBrightness&&(e+=" "+d.brightness),b.shadowBox&&(e+=" shadowBox"),c+="<div class='image-content'><div class='image "+e+"' style='",c+="width:"+b.width+"px;",c+="height:"+b.height+"px;",c+="background-image:url("+d.image.src+");",c+="'>&nbsp;</div>",b.showComments&&"undefined"!=typeof d.comment&&""!=d.comment&&(c+="<div class='comments'><div class='comments-content'>"+d.comment+"</div></div>"),c+="</div>"}}),c+="</div></div>",this.showTopNav&&(c+="<div class='top-navigation'><div class='prev'><span></span></div><div class='next'><span></span></div></div>"),this.showNav&&(c+="<div class='navigation'><div class='prev'></div><div class='next'></div><br clear='all' /></div>"),this.showThumbnail&&(c+="<div class='thumbnail-navigation'>",c+="<div class='thumbnail-prev'></div><div class='thumbnail-next'></div>",c+="<div class='thumbnail-content'>",$(this.imgArray).each(function(a,d){if(d){var e="horizontalFormat";this.width<d.image.height&&b.verticalFormat&&(e="verticalFormat"),c+="<div class='image "+e+"' style='background-image:url("+d.image.src+");'>&nbsp;</div>"}}),c+="</div></div>"),this.showNavPoints&&(c+="<div class='nav-points'><div class='points-content'>",$(this.imgArray).each(function(a,b){b&&(c+="<div class='point'><span>"+(a+1)+"</span></div>")}),c+="</div></div>"),this.showPageNum&&(c+="<div class='pagenum'><div class='num'>0</div><div class='max'>0</div><br clear='all' /></div>"),$(this.obj).append(c),a&&a()},start:function(){var a=this;if(this.setStatus(),this.startAutoplay(),this.setSize(),$(this.obj).click(function(){a.mouseFirstEvent=!0}),$(window).resize(function(){a.setSize()}),(this.showNav||this.showTopNav)&&($(this.obj).find(".next").click(function(){a.next()}),$(this.obj).find(".prev").click(function(){a.prev()})),$(this.obj).find(".loader").fadeOut(500).remove(),this.showThumbnail){this.thumbnailContent=$(this.obj).find(".thumbnail-navigation .thumbnail-content"),$(this.thumbnailContent).children(".image").click(function(){a.goto($(this).index()),a.mouseFirstEvent=!0});var b=$(this.obj).find(".thumbnail-navigation .thumbnail-content .image").last(),c=$(b).position();this.thumbnailContentWidth=c.left+$(b).width();var d=$($(this.thumbnailContent).children(".image").get(1)).position();this.thumbnailWidth=d.left,$(this.obj).find(".thumbnail-navigation .thumbnail-prev").click(function(){a.thumbnailScrollPrev()}),$(this.obj).find(".thumbnail-navigation .thumbnail-next").click(function(){a.thumbnailScrollNext()})}this.showNavPoints&&$(this.obj).find(".nav-points .points-content .point").click(function(){a.goto($(this).index())}),this.touchControl&&(this.touchStart=!1,this.touchEnd=!1,$(this.obj).bind("touchstart",function(b){a.touchStart=!1,a.touchEnd=0}),$(this.obj).bind("touchmove",function(b){0==a.touchStart&&(a.touchStart=b.originalEvent.touches[0].pageX),a.touchEnd=b.originalEvent.touches[0].pageX}),$(this.obj).bind("touchend",function(b){var c=a.touchEnd-a.touchStart;c<0&&c<-50&&a.next(),c>0&&c>50&&a.prev(),a.touchStart=!1,a.touchEnd=0})),this.keyControl&&$(document).keydown(function(b){37==b.keyCode&&(b.preventDefault(),a.prev()),39==b.keyCode&&(b.preventDefault(),a.next())}),this.shadowBox&&$(this.obj).find(".overflow .inner-content").click(function(){if("undefined"!=typeof Shadowbox){var b=new Array;$(a.imgArray).each(function(c,d){a.shadowBoxComments?b[c]={content:d.image.src,player:"img",title:d.comment}:b[c]={content:d.image.src,player:"img",title:""}}),Shadowbox.open(b),Shadowbox.change(a.position)}else this.message("Shadowbox not Found")}),this.imageNum>=1&&$(this.obj).find(".overflow .image-content").first().addClass("start"),$(this.obj).children(".overflow").animate({opacity:1},500,function(){a.fx&&a.fx()})},startAutoplay:function(){if(this.autoplay){var a=this,b=!0;clearInterval(this.loop),this.autoStop&&this.mouseFirstEvent&&(b=!1),"ken-burns"==this.animateType&&(b=!0),b&&(this.loop=setInterval(function(){a.next()},this.showTime))}},next:function(){if(!this.fadeStatus){var a=this;this.fadeStatus=!0,this.lastPosition=this.position,this.position++,this.position==this.imageNum&&(this.position=0),this.animate(function(){a.startAutoplay(),a.fadeStatus=!1})}},prev:function(){if(!this.fadeStatus){var a=this;this.fadeStatus=!0,this.lastPosition=this.position,this.position--,this.position<0&&(this.position=this.imageNum-1),this.animate(function(){a.startAutoplay(),a.fadeStatus=!1})}},goto:function(a){if(a!=this.position){var b=this;this.fadeStatus=!0,this.position=a,this.animate(function(){b.startAutoplay(),b.fadeStatus=!1})}},animate:function(a){var c=$(this.obj).find(".overflow .inner-content"),d=$(this.obj).find(".overflow .image-content"),e=$(d).get(this.position),f=$(d).get(this.lastPosition);switch(this.animateType){case"slide":$(d).removeClass("start"),$(c).animate({left:this.width*this.position*-1},this.animateSpeed,this.easingType,function(){a&&a()});break;case"slide-vertical":$(d).removeClass("start"),$(c).animate({top:this.height*this.position*-1},this.animateSpeed,this.easingType,function(){a&&a()});break;case"fade":$(d).removeClass("start"),$(f).css("z-index",1),$(e).hide().css("z-index",2).fadeIn(this.animateSpeed,this.easingType,function(){$(d).not(e).css("z-index",0).hide(),$(e).css("z-index",1),a&&a()});break;case"ken-burns":this.imageNum>1?(x=Math.round(3*Math.random()),y=Math.round(3*Math.random()),$(e).attr("data-x",x),$(e).attr("data-y",y),$(f).css("z-index",1),$(e).removeClass("reset").css({opacity:0,"z-index":2}).addClass("play").animate({opacity:1},2e3,function(){$(d).not(f).not(e).removeClass("play").addClass("reset").css("z-index",0),$(d).removeClass("start"),a&&a()})):this.message("min. 2 Images");break;case"gallery":$(d).removeClass("start"),a&&a();break;default:this.message("no animation type")}this.setStatus(c,d,e,f)},thumbnailScrollNext:function(){var a=$(this.thumbnailContent).position(),b=$(this.obj).children(".thumbnail-navigation").width(),c=a.left+this.thumbnailWidth*this.scrollThumbnailNum*-1;this.thumbnailContentWidth-b<c*-1&&(c=(this.thumbnailContentWidth-b)*-1),this.thumbnailContentWidth-b>a.left*-1&&$(this.thumbnailContent).stop().animate({left:c},500,this.easingType)},thumbnailScrollPrev:function(){var a=$(this.thumbnailContent).position(),b=a.left+this.thumbnailWidth*this.scrollThumbnailNum;0>b*-1&&(b=0),a.left<0&&$(this.thumbnailContent).stop().animate({left:b},500,this.easingType)},thumbnailScrollToActive:function(){var a=$(this.thumbnailContent).find(".aktiv"),b=$(this.obj).children(".thumbnail-navigation").width();if($(a).length){var c=$(a).position(),d=c.left*-1;0>d*-1&&(d=0),this.thumbnailContentWidth-b<d*-1&&(d=(this.thumbnailContentWidth-b)*-1),d<=0&&this.thumbnailContentWidth-this.width>=d*-1&&$(this.thumbnailContent).stop().animate({left:d},500,this.easingType)}},setSize:function(){var a=this,b=$(this.obj).find(".overflow .inner-content");this.width=$(this.obj).width(),this.height=$(this.obj).height(),"slide"==this.animateType&&$(b).css({left:this.width*this.position*-1,width:this.imageNum*this.width+1e3}),$($(b).find(".image-content .image")).each(function(b,c){$(this).css({width:a.width,height:a.height})})},setStatus:function(a,b,c,d){if($(b).removeClass("aktiv"),$(c).addClass("aktiv"),this.showThumbnail){var e=$(this.obj).find(".thumbnail-navigation .thumbnail-content .image"),f=$(e).get(this.position);$(e).removeClass("aktiv"),$(f).addClass("aktiv")}if(this.showNavPoints){var g=$(this.obj).find(".nav-points .points-content .point"),h=$(g).get(this.position);$(g).removeClass("aktiv"),$(h).addClass("aktiv")}this.showThumbnail&&this.autoThumbnailScroll&&this.thumbnailScrollToActive(),this.showPageNum&&($(this.obj).find(".pagenum .max").text(this.imageNum),$(this.obj).find(".pagenum .num").text(this.position+1)),this.detectBrightness&&$(this.obj).attr("data-brightness",this.imgArray[this.position].brightness)},imageLoader:function(a,b,c){a.complete||4===a.readyState?$(a).load(function(a,c,d){b&&b()}).error(function(){c&&c()}):b&&b()},setBrightness:function(a){if(self.detectBrightness){var b=0,c=document.createElement("canvas").getContext("2d");c.width=100,c.height=100,c.drawImage(a.image,0,0,100,100);var d=c.getImageData(0,0,100,100),e=$(d.data).length;$(d.data).each(function(a,c){b+=c});var f=b/(255*e);f>.8&&(a.brightness="light"),f<.8&&f>.5&&(a.brightness="medium"),f<.5&&f>0&&(a.brightness="dark")}},message:function(a){if(this.beta)if($("#cis_error_message").length){var b="<div class='cis_error_message' style='font-size:10px; text-align:left; line-height: 25px; border-bottom:solid 1px #ddd; padding-left:5px;'><div>";$("#cis_error_message_titel").after(b),$(".cis_error_message").first().text("- "+a)}else{var b="<div id='cis_error_message' style='position:absolute; top:10px; left:10px; z-index:100000; height:100px; width:250px; border:solid 2px #000; display:none;background-color:#fff; overflow: auto;'>";b+="<h3 id='cis_error_message_titel' style='display:block; text-align:center; background-color:#666; color:#fff; font-size:12px; line-height: 25px!important; margin:0px;'>ERROR</h3>",b+="<div class='cis_error_message' style='font-size:10px; text-align:left; line-height: 25px; border-bottom:solid 1px #ddd; padding-left:5px;'><div>",b+="</div>",$(this.obj).append(b),$(".cis_error_message").text("- "+a),$("#cis_error_message").fadeIn(500)}}};