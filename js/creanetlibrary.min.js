var CreanetLibrary=function(options){for(var name in this.options=$.extend({initMobile:!1,beforeFunction:!1,afterFunction:!1,historyLetter:"c",appendedClasses:"",beta:!1},options),this.isMobile,this.options)eval("this."+name+"=this.options."+name);this.initModule(),this.initHandlers()};CreanetLibrary.prototype={initHandlers:function(){var r=this;$(document).on("click","a",function(t){"#"!=$(this).attr("href")&&!$(this).attr("data-url")||t.preventDefault()}),$(document).on("click",".ajaxloader",function(t){$(t.target).hasClass("dontload")||(r.options.appendedClasses=$(this).attr("data-class"),r.ajaxloader({cisDiv:$(this).attr("data-div"),cisTop:$(this).attr("data-top"),cisTopMobile:$(this).attr("data-topmobile"),cisURL:$(this).attr("data-url"),cisOverlay:$(this).attr("data-overlay"),cisClass:$(this).attr("data-class"),cisOnce:$(this).attr("data-once"),cisScrolltop:$(this).attr("data-scrolltop"),cisScrollToDiv:$(this).attr("data-scrolltodiv"),cisScrollAnimation:$(this).attr("data-scrollanimation"),obj:this}))}),$(document).on("click change",".ajaxformelement",function(t){(!$(this).is("select")&&"click"==t.type||$(this).is("select")&&"change"==t.type)&&r.ajaxform(this)}),$(document).on("reset",".ajaxform",function(t){t.preventDefault(),$(this).find("select").each(function(t,a){$(a).prop("selectedIndex",0)}),$(this).find("input[type=text]").each(function(t,a){$(a).val("")}),r.ajaxform(this)}),$(document).on("keypress",".ajaxform input[type=text]:not(.noAjax)",function(t){13==t.keyCode&&(t.preventDefault(),r.ajaxform(this))}),$(document).on("change",".ajaxform select, .ajaxform input[type=radio], .ajaxform input[type=checkbox]",function(t){$(this).hasClass("noAjax")||r.ajaxform(this)}),$(document).on("click",".ajaxform input[type=submit], .ajaxform button[type=submit]",function(t){t.preventDefault(),r.ajaxform(this)}),$(document).on("click",".ajaxclose",function(){var t=$(this).attr("data-div");null==t&&(t="ajaxdiv");var a=new CustomEvent("ajaxCloseEvent",{detail:t});"ajaxdiv"==t&&document.dispatchEvent(a),null==$(this).attr("data-overlay")&&$("#overlay").fadeOut(200),$("#"+t).fadeOut(200,function(){$("body").removeClass("hide-scrollbar"),$(this).removeClass(r.options.appendedClasses)}),$("#"+t+" iframe").each(function(t,a){var e;void 0!==$(a).attr("src")&&(e=(e=(e=$(a).attr("src")).replace("autoplay=1","autoplay=0")).replace("autoplay=true","autoplay=false"),$(a).attr("src",""),$(a).attr("src",e))}),$("#"+t+" video").each(function(t,a){$(a).remove()}),r.clearHistory()}),$(document).on("click",'a[href^="#scrollto="]',function(t){t.preventDefault();var a=parseInt($(this).attr("data-additionalscroll")),e=$(this).attr("href"),o=e.substring(e.indexOf("=")+1),i=0,i=isNaN(o)?$("#"+o).offset().top:o;isNaN(a)||(i+=a),r.scrollTo(i)}),$(document).on("click",".dscontextshow",function(t){DSContextShow(t,$(this).attr("data-div"))}),$(document).on("click",".dscontextmenucontent",function(){DSContextHide()}),window.addEventListener("hashchange",function(t){""==window.location.hash&&$(".ajaxclose").click()},!1),this.openHistoryRecall();var e="state"in window.history&&null!==window.history.state,o=location.href;void 0===$("[data-hash]")[0]&&$(window).bind("popstate",function(t){var a=!e&&location.href==o;e=!0,a||(console.log("popstate",t),window.location.href=location.href)});for(var t=document.querySelectorAll('a[target="_blank"]'),a=0;a<=t.length-1;a++){var i=t[a].rel.split(" ");-1==i.indexOf("noopener")&&i.push("noopener"),-1==i.indexOf("noreferrer")&&i.push("noreferrer"),t[a].rel=i.join(" ")}window.cisIsReady=!0},checkIsMobile:function(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},initModule:function(){var t=this;this.options.initMobile&&(this.isMobile={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return t.isMobile.Android()||t.isMobile.BlackBerry()||t.isMobile.iOS()||t.isMobile.Opera()||t.isMobile.Windows()}})},ajaxloader:function(t){var i=(t=$.extend({cisDiv:!1,cisTop:90,cisTopMobile:!1,cisURL:!1,cisOverlay:!1,cisClass:!1,cisOnce:!1,cisScrolltop:!1,cisScrollToDiv:!1,cisScrollAnimation:0,animateSpeed:700,beforeFunction:this.beforeFunction,afterFunction:this.afterFunction,obj:!1},t)).cisDiv,a=t.cisTop,e=t.cisTopMobile,o=dsxpath+"dynasite.cfm?"+t.cisURL+"&skipfurl=1",r=t.cisOverlay,s=t.cisClass,n=t.cisOnce,l=t.cisScrolltop,c=t.cisScrollToDiv,d=t.cisScrollAnimation,p=t.animateSpeed,h=t.beforeFunction,u=t.afterFunction,f=t.obj,m=$(document).scrollTop(),v=!1;function g(t,a){a=a||{bubbles:!1,cancelable:!1,detail:void 0};var e=document.createEvent("CustomEvent");return e.initCustomEvent(t,a.bubbles,a.cancelable,a.detail),e}"function"!=typeof window.CustomEvent&&(g.prototype=window.Event.prototype,window.CustomEvent=g);var x,y=new CustomEvent("ajaxBeforeEvent",{detail:t}),b=new CustomEvent("ajaxAfterEvent",{detail:t});h&&1==$(f).attr("data-beforeFx")&&h(f),"ajaxdiv"==i&&document.dispatchEvent(y),"ajaxdiv"==i&&$("#"+i).attr("class","ajaxdiv"),null!=s&&$("#"+i).addClass(s),window.innerHeight<700&&(a=0!=e?e:35),0!=a&&$("#"+i).css("top",parseInt(m)+parseInt(a)+"px"),1==r&&($("#overlay").hasClass("ajaxclose")&&(v=!0),v&&$("#overlay").removeClass("ajaxclose"),$("#overlay").show()),null!=$(f).attr("data-animatespeed")&&(p=parseInt($(f).attr("data-animatespeed"))),0!=l&&(x=0),0!=c&&(x=$("#"+c).offset().top),!n||$("#"+i).is(":empty")?(this.setHistoryRecall(f),$("#"+i).load(o,"",function(t,a,e){$("#"+i).hide().fadeIn(p,function(){document.dispatchEvent(b),u&&1==$(f).attr("data-afterFx")&&u(f)}),1==r&&v&&$("#overlay").addClass("ajaxclose"),null!=x&&$("body,html").animate({scrollTop:x},d);var o=parseInt($("#"+i).css("height"))+parseInt($("#"+i).css("margin-top"))+parseInt($("#"+i).css("margin-bottom"));$(".overlay > .ajaxclose").css("min-height",o+"px")})):($("#"+i).show(),v&&1==r&&$("#overlay").addClass("ajaxclose")),"ajaxdiv"==i&&$("body").addClass("hide-scrollbar")},getUrlParams:function(){var t=location.search.slice(1).split("&"),e=[];return t.forEach(function(t){if(t.length<=2)return!1;var a=t.split("=");if(void 0===a[0]||void 0===a[1])return!1;"page"!=a[0]&&"dsmid"!=a[0]&&e.push({name:a[0],value:a[1]})}),e},setHistoryRecall:function(t){var a,e;""!=this.getUrlVar(this.historyLetter)&&this.clearHistory(),null==$(t).attr("data-history")&&null==$(t).attr("data-page")||(e="",a="?",e=document.URL.substr(0,document.URL.indexOf("?")),""!=this.getUrlVar("dsmid")&&(e+=a+"dsmid="+this.getUrlVar("dsmid").replace("?",""),a="&"),$(".ajaxloader[data-history='"+$(t).attr("data-history")+"']").length&&(e+=a+this.historyLetter+"="+$(t).attr("data-history"),a="&"),void 0!==$(t).attr("data-Page")?e+=a+"page="+$(t).attr("data-Page"):""!=this.getUrlVar("page")&&(e+=a+"page="+this.getUrlVar("page")),void 0!==$(t).attr("data-historyparam")&&(e+=a+$(t).attr("data-historyparam")),this.getUrlParams().forEach(function(t){e+="&"+t.name+"="+t.value}),void 0!==history.pushState&&window.history.replaceState(null,$(t).attr("data-history"),e)),null!=$(t).attr("data-hash")&&(location.hash=$(t).attr("data-hash"))},openHistoryRecall:function(){var e,o,i;""!=this.getUrlVar(this.historyLetter)?(e=this.getUrlVar(this.historyLetter),i="",$(".ajaxloader[data-history]").each(function(t,a){e==$(a).attr("data-history")&&(i=$(this))}),$(i).length?this.ajaxloader({cisDiv:$(i).attr("data-div"),cisTop:$(i).attr("data-top"),cisURL:$(i).attr("data-url"),cisOverlay:$(i).attr("data-overlay"),cisClass:$(i).attr("data-class"),cisOnce:$(i).attr("data-once"),cisScrolltop:$(i).attr("data-scrolltop"),cisScrollToDiv:$(i).attr("data-scrolltodiv"),obj:i}):console.log("Kein Objekt gefunden")):""!=window.location.hash&&(o=window.location.hash.replace("#",""),i="",$(".ajaxloader[data-hash]").each(function(t,a){o==$(a).attr("data-hash")&&(i=$(this))}),void 0!==$(i)?this.ajaxloader({cisDiv:$(i).attr("data-div"),cisTop:$(i).attr("data-top"),cisURL:$(i).attr("data-url"),cisOverlay:$(i).attr("data-overlay"),cisClass:$(i).attr("data-class"),cisOnce:$(i).attr("data-once"),cisScrolltop:$(i).attr("data-scrolltop"),cisScrollToDiv:$(i).attr("data-scrolltodiv"),obj:i}):console.log("Kein Objekt gefunden"))},clearHistory:function(t){var a="?",e=document.URL.substr(0,document.URL.indexOf("?"));""!=this.getUrlVar("dsmid")&&(e+=a+"dsmid="+this.getUrlVar("dsmid").replace("?",""),a="&"),""!=this.getUrlVar("page")&&(e+=a+"page="+this.getUrlVar("page").replace("&","")),void 0!==history.pushState&&window.history.replaceState(null,null,e)},replaceURL:function(t){return null!=t&&(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/ /g,"")).replace(/ä/g,"ae")).replace(/ö/g,"oe")).replace(/ü/g,"ue")).replace(/Ä/g,"AE")).replace(/Ö/g,"OE")).replace(/Ü/g,"UE")).replace(/ß/g,"ss")).replace(/É/g,"e")).replace(/È/g,"e")).replace(/é/g,"e")).replace(/è/g,"e")).replace(/À/g,"a")).replace(/à/g,"a")).replace(/&/g,"")).replace(/'/g,"")).replace(/,/g,"")).replace(/:/g,"")).replace("?","").replace(",",""))},ajaxform:function(a){var t,e,o,i,r=this,s=400,n=$(document).scrollTop();this.beforeFunction&&1==$(a).attr("data-beforeFx")&&this.beforeFunction(a),$(a).is("form")?t=a:null!=$(a).attr("data-formid")?t=$("#"+$(a).attr("data-formid")):null!=$(a).parents("form.ajaxform")?t=$(a).parents("form.ajaxform"):console.log("ajaxForm Error"),e=$(t).attr("data-action"),o=$(t).attr("data-div"),$(a).hasClass("ajaxformelement")&&null!=$(a).attr("data-scrolltop")&&(i=0),$(a).hasClass("ajaxformelement")&&null!=$(a).attr("data-scrolltodiv")&&(i=$("#"+$(a).attr("data-scrolltodiv")).offset().top),null!=$(t).attr("data-animatespeed")&&(s=parseInt($(t).attr("data-animatespeed"))),null!=$(a).attr("data-urlparam")&&(e=e+"&"+$(a).attr("data-urlparam"));var l=dsxpath+"dynasite.cfm?"+e+"&skipfurl=1";this.setHistoryRecall(a),$.ajax({type:"POST",url:l,data:$(t).serialize(),success:function(t){$("#"+o).hide().html(t).fadeIn(s),r.afterFunction&&1==$(a).attr("data-afterFx")&&r.afterFunction(a),null!=i&&i<n&&$("body,html").animate({scrollTop:i},0)},error:function(t,a,e){console.log("AJAX Error"),console.log(l),console.log(t),console.log(a),console.log(e)}})},scrollTo:function(t){$("html,body").animate({scrollTop:t},800)},setVar:function(name,value){eval("this."+name+"=value")},loadScript:function(t,a){""!=t&&$.getScript(t,function(){return a&&a(),!0})},loadCSS:function(t,a){$("head").append("<link rel='stylesheet' type='text/css' href='"+t+"' />",function(){a&&a()})},getUrlVar:function(t){var a=new RegExp(t+"=([^&]*)","i").exec(window.location.search);return a&&unescape(a[1])||""},beta:function(t){if(this.options.beta){console.log("--- BETA AKTIV ---");try{return t&&(console.log("--\x3e FX START"),t(),console.log("--\x3e FX SUCCESSFUL END")),console.log("--- BETA END ---"),"Successful"}catch(t){var a="- Error: "+t.message;return console.log(a),console.log("--- BETA ERROR END ---"),a}}},message:function(t){var a;this.options.beta&&($("#cis_error_message").length?(a="<div class='cis_error_message' style='font-size:10px; text-align:left; line-height: 25px; border-bottom:solid 1px #ddd; padding-left:5px;'><div>",$("#cis_error_message_titel").after(a),$(".cis_error_message").first().text("- "+t)):(a="<div id='cis_error_message' style='position:fixed; top:10px; left:10px; z-index:100000; height:200px; width:300px; border:solid 2px #000; display:none;background-color:#fff; overflow: auto;'>",a+="<h3 id='cis_error_message_titel' style='display:block; text-align:center; background-color:#666; color:#fff; font-size:12px; line-height: 25px!important; margin:0px;'>Console</h3>",a+="<div class='cis_error_message' style='font-size:10px; text-align:left; line-height: 25px; border-bottom:solid 1px #ddd; padding-left:5px;'><div>",a+="</div>",$("body").append(a),$(".cis_error_message").text("- "+t),$("#cis_error_message").fadeIn(500)))}};